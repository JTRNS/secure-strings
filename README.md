# Secure Strings

Browser compatible convenience wrapper for signing and / or encrypting data using Web Crypto API methods.

## Encrypt and Decrypt

These functions use the AES-GCM encryption algorithm to encrypt the plaintext and generate a ciphertext, and then decrypt the ciphertext back to the original plaintext using the provided password.

```ts
encrypt(plaintext: string, password: string)
```

The plaintext is first encoded as bytes using the TextEncoder interface, and then encrypted using the AES-GCM algorithm with a randomly generated initialization vector (IV) and a derived encryption key from the provided password and salt using PBKDF2. The ciphertext, salt, and IV are then concatenated as bytes, and finally returned as a base64 URL encoded string;

```ts
decrypt(cipher: string, password: string)
```

The encrypted ciphertext is first decoded using the base64 URL decoding scheme, and then separated into its salt, IV, and ciphertext components as bytes. The encryption key is then derived from the provided password and salt, and used to decrypt the ciphertext using the AES-GCM algorithm with the provided IV. The decrypted ciphertext is then decoded as a UTF-8 string using the TextDecoder interface, and returned as the original plaintext.

```js
import { encrypt, decrypt } from "@jtrns/secure-strings";

const password = "my-password";
const plaintext = "hello world";

// Encrypt the plaintext
const ciphertext = await encrypt(plaintext, password);

// Decrypt the ciphertext
const decryptedText = await decrypt(ciphertext, password);

console.log(decryptedText); // 'hello world'
```

## Sign and Verify

These functions are designed to work in combination, where the sign function generates a signature for a given message using a secret key, and the verify function checks if the generated signature matches the original message and secret key.

```ts
type HmacHash = "SHA-256" | "SHA-384" | "SHA-512";
sign(message: string, secret: string, algorithm?: HmacHash)
```

The signed data is generated by encoding the hashing algorithm name, message and signature in a byte array, and then base64 URL encoding the bytes into a string.

```ts
verify(signedMessage: string, secret: string)
```

The base64 url encoded signed data is decoded to extract the hashing algorithm, signed message, and signature from the byte array. The signed message and signature are then used to verify the signature against the original message and secret key using the same hashing algorithm as was used for signing.

### Example Usage

```js
import { sign, verify } from "@jtrns/secure-strings";

const secret = "my-secret-key";
const value = "hello world";

// Sign the value
const signedValue = await sign(value, secret);

// Verify the signed value
const isVerified = await verify(signedValue, secret);

if (isVerified) {
  console.log("The signature is valid");
} else {
  console.log("The signature is not valid");
}
```
